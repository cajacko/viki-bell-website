FROM node:latest

EXPOSE 5000
COPY web/package.json /var/www/web/package.json
WORKDIR /var/www/web
RUN npm install
RUN npm install pm2 -g
COPY .env /var/www/.env
COPY .env-sample /var/www/.env-sample
COPY web /var/www/web
RUN npm run build:production

CMD ["pm2-docker", "/var/www/web/dist/server/index.js"]
